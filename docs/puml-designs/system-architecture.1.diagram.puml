@startuml
!define RECTANGLE class
!define DATABASE database
!define CLOUD cloud

skinparam componentStyle uml2
skinparam component {
  BackgroundColor White
  BorderColor Black
  ArrowColor Black
}

package "Client Layer" {
  [Web Browser] as WebClient
  [Desktop App (Electron)] as DesktopClient
  [Mobile App] as MobileClient
}

package "Frontend Layer" {
  [React/Next.js Components] as FrontendComponents
  [State Management] as StateManagement
  [UI Components] as UIComponents
}

package "API Gateway Layer" {
  [API Gateway] as APIGateway
  [Load Balancer] as LoadBalancer
  [Rate Limiter] as RateLimiter
}

package "Microservices Layer" {
  package "Core Services" {
    [Authentication Service] as AuthService
    [User Management Service] as UserService
    [File Management Service] as FileService
    [Environment Service] as EnvService
  }

  package "Communication Services" {
    [Real-time Service] as RealTimeService
    [Messaging Service] as MessagingService
    [Video Call Service] as VideoService
  }

  package "Integration Services" {
    [Third-party Integration Service] as IntegrationService
    [AI Service] as AIService
  }
}

package "Data Layer" {
  database "MongoDB" as MongoDB
  database "Redis Cache" as Redis
  database "File Storage" as FileStorage
}

cloud "External Services" {
  [Google Workspace] as GoogleAPI
  [Microsoft 365] as MicrosoftAPI
  [OpenAI/Gemini] as AIAPI
}

' Client to Frontend connections
WebClient --> FrontendComponents
DesktopClient --> FrontendComponents
MobileClient --> FrontendComponents

' Frontend to API Gateway connections
FrontendComponents --> APIGateway
APIGateway --> LoadBalancer
LoadBalancer --> RateLimiter

' API Gateway to Microservices connections
RateLimiter --> AuthService
RateLimiter --> UserService
RateLimiter --> FileService
RateLimiter --> EnvService
RateLimiter --> RealTimeService
RateLimiter --> MessagingService
RateLimiter --> VideoService
RateLimiter --> IntegrationService
RateLimiter --> AIService

' Microservices to Data Layer connections
AuthService --> MongoDB
UserService --> MongoDB
FileService --> FileStorage
EnvService --> MongoDB
RealTimeService --> Redis
MessagingService --> MongoDB
VideoService --> Redis
IntegrationService --> MongoDB
AIService --> Redis

' Integration Services to External Services connections
IntegrationService --> GoogleAPI
IntegrationService --> MicrosoftAPI
AIService --> AIAPI

@enduml